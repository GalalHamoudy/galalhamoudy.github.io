<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>0xM4LG4L4L</title>
    <meta name="description"
        content="a Blog of a very ambitious and self-motivated person, constantly looking for new and effective ways to achieve my pioneering goals">
    <meta name="author" content="Mohamed Galal Assaf" />
    <link href="./images/skull.png" rel="icon">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" media="screen" href="css/bootstrap.min.css">
    <link rel="stylesheet" media="screen" href="css/bootstrap-icons.min.css">
    <link rel="stylesheet" media="screen" href="css/animate.min.css">
    <link rel="stylesheet" media="screen" href="css/style.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cabin:ital@1&family=Lumanosimo&display=swap" rel="stylesheet">


<body>


    <!-- particles.js container -->
    <div id="particles-js"></div>

    <!-- navbar container -->
    <nav class="navbar navbar-expand-lg py-3 ">
        <div class="pe-lg-0 ps-lg-5 container-fluid justify-content-between">
            <a class="navbar-brand me">Mohamed Galal Assaf</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
                <div class="nav_left d-lg-flex align-items-center">
                    <nav>
                        <div class="nav d-block d-lg-flex nav-tabs" id="nav-tab" role="tablist">
                            <a href="./index.html"><button class="nav-link" type="button"><i
                                        class="bi bi-house-fill"></i> Home</button></a>
                            <a href="./About_Me.html"><button class="nav-link" type="button"><i
                                        class="bi bi-person-fill"></i> About Me</button></a>
                            <a href="./Useful_resources.html"><button class="nav-link" type="button"><i
                                        class="bi bi-link-45deg"></i> Useful resources</button></a>
                            <a href="./My_write_ups.html"><button class="nav-link" type="button"><i
                                        class="bi bi-pencil-square"></i> My write-ups</button></a>
                            <a href="./CTF_competitions.html"><button class="nav-link active" type="button"><i
                                        class="bi bi-bar-chart-line-fill"></i> CTF
                                    competitions</button></a>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </nav>




    <!-- container -->
    <div class="container">
        <div class="card mb-3">
            <div class="card-body">
                <h5 class="card-title mgf">Blackhat MEA CTF 2022</h5>
                <p class="card-text">My write-ups to all Digital Forensics & Reverse challenges in Blackhat MEA CTF 2022
                </p>
                <hr>
                <div class="portfolio-wrap mt-4 mb-4">
                    <img src="images/portfolio/2.jpg" class="img-fluid" alt="">
                </div>
                <hr>
                In this CTF competition, we got 29th place after great work and speed in solving challenges
                <hr>
                <div class="portfolio-wrap mt-4 mb-4">
                    <img src="images/BlHt/1.png" class="img-fluid" alt="">
                </div>
            </div>
        </div>
    </div>



    <!-- container -->
    <!-- <div class="container">
        <div class="card mb-3">
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-12">
                        <ul class="list-group" style="text-align: left;">
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Name : <i
                                    class="bi bi-activity"></i> deviation </li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Category: <i
                                    class="bi bi-activity"></i> Reverse </li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Level: <i
                                    class="bi bi-activity"></i> Medium</li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Flag : <i
                                    class="bi bi-activity"></i> CYCTF{UND3RST4ND1NG_H0W_S3H_W0RK5_1S_ESS3NTI4L}</li>
                        </ul>
                    </div>
                </div>
                <img src="images/cyctf/r1/7.jpg" class="img-fluid" alt="">
                <h5 class="card-title mgf">SOLUTION</h5>
                <ul class="list-group" style="text-align: left;">
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> </li>
                </ul>
            </div>
        </div>
    </div> -->
    <div class="container">
        <div class="card mb-3">
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-12">
                        <ul class="list-group" style="text-align: left;">
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Name : <i
                                    class="bi bi-activity"></i> Bus </li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Category: <i
                                    class="bi bi-activity"></i> DIGITAL FORENSIC </li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Level: <i
                                    class="bi bi-activity"></i> Medium</li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Flag : <i
                                    class="bi bi-activity"></i> BlackHatMEA{Modbus_is_easy_after_all!}</li>
                        </ul>
                    </div>
                </div>
                <p class="fst-italic">
                    We have established our communication protocol , and it is in testing phase . The message
                    transmission is secure and can't be retrieved . It's up to you to tell us how secure it is .
                </p>
                <h5 class="card-title mgf">SOLUTION</h5>
                <ul class="list-group" style="text-align: left;">
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> the pcap file was look
                        like that ( i use "Modbus" as a filter ) :
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/2.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> i notice some important
                        points <br>
                        1- the protocol Modbus.data is always 0000 or ff00 <br>
                        2- the tcp destinion port is not constant and the massage sent to port = 502 :
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/3.png" class="img-fluid" alt="">
                        </div>
                        <hr>
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/4.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> so i used tshark tool to
                        get the data :
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/5.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> i replace 0000 by 0 and
                        ff00 by 1 :
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/6.png" class="img-fluid" alt="">
                        </div>
                        <br>
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/7.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> then i used cyberchef :
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/8.png" class="img-fluid" alt="">
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="card mb-3">
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-12">
                        <ul class="list-group" style="text-align: left;">
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Name : <i
                                    class="bi bi-activity"></i> MEM </li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Category: <i
                                    class="bi bi-activity"></i> DIGITAL FORENSIC </li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Level: <i
                                    class="bi bi-activity"></i> Medium</li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Flag : <i
                                    class="bi bi-activity"></i> BlackHatMEA{Password_hints_are_the_retrievable}</li>
                        </ul>
                    </div>
                </div>
                <p class="fst-italic">
                    My work PC has suddenly crashed . I can no longer retrieve my secret file , also I don't remember
                    the password . It is a hard password and securely generated , but i saved it locally . Can you help
                    me recover the content ?
                </p>
                <h5 class="card-title mgf">SOLUTION</h5>
                <ul class="list-group" style="text-align: left;">
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> it is raw image so i used
                        Volatility :
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/9.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> then start to use some
                        plugins </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> when i used filescan
                        plugin , i found "flag.rar" :
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/10.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> so i dumped it , but i
                        cannot open it because it has password:
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/11.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> so i start to use some
                        plugins to search for password , and i found it at "envars" plugin
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/12.png" class="img-fluid" alt="">
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="card mb-3">
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-12">
                        <ul class="list-group" style="text-align: left;">
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Name : <i
                                    class="bi bi-activity"></i> registry </li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Category: <i
                                    class="bi bi-activity"></i> Reverse Engineering </li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Level: <i
                                    class="bi bi-activity"></i> Medium</li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Flag : <i
                                    class="bi bi-activity"></i> Flag{3mbed_ex3_1n_s3lf_3xecut1ng_r3g_f1le}</li>
                        </ul>
                    </div>
                </div>
                <p class="fst-italic">
                    My work PC has suddenly crashed . I can no longer retrieve my secret file , also I don't remember
                    the password . It is a hard password and securely generated , but i saved it locally . Can you help
                    me recover the content ?
                </p>
                <h5 class="card-title mgf">SOLUTION</h5>
                <ul class="list-group" style="text-align: left;">
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> it is reg file so i used
                        flare-vm :
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/13.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> i started by open reg file
                        code </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> I see some powershell
                        scripts (the script add file with extension .exe in temp file and add value in registry) :
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/14.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> i go to temp location to
                        see if there is any change before i merge the file and after
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/15.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> then i merge the file
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/16.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> then i go to registry to
                        see the location which was in powershell script , and there was new registry in runOnce
                        "startup_entry"
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/17.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> so i decide to restart the
                        flare-vm
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/18.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> i notice new file in temp
                        location and it was with extension .exe
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/19.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> so i used Ida pro with
                        this file
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/20.png" class="img-fluid" alt="">
                        </div>
                        <br>
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/21.png" class="img-fluid" alt="">
                        </div>
                        <br>
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/22.png" class="img-fluid" alt="">
                        </div>
                        <br>
                        <div class="portfolio-wrap mt-4 mb-4">
                            <img src="images/BlHt/23.png" class="img-fluid" alt="">
                        </div>
                    </li>
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> and i found the flag</li>
                </ul>
            </div>
        </div>
    </div>





    <div class="container">
        <div class="card mb-3">
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-12">
                        <ul class="list-group" style="text-align: left;">
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Name : <i
                                    class="bi bi-activity"></i> FinalGate </li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Category: <i
                                    class="bi bi-activity"></i> Reverse Engineering </li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Level: <i
                                    class="bi bi-activity"></i> Medium</li>
                            <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> Flag : <i
                                    class="bi bi-activity"></i> Flag{p4s5ing_th3_g4te}</li>
                        </ul>
                    </div>
                </div>
                <p class="fst-italic">No Description </p>
                <h5 class="card-title mgf">SOLUTION</h5>
                <ul class="list-group" style="text-align: left;">
                    <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> it is exe file so i used flare-vm :
                        <div class="portfolio-wrap mt-4 mb-4">
                          <img src="images/BlHt/13.png" class="img-fluid" alt="">
                        </div>
                      </li>
                      <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> i started by open exports tab  </li>
                      <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> I see two TLScallback function so i open them :
                        <div class="portfolio-wrap mt-4 mb-4">
                          <img src="images/BlHt/24.png" class="img-fluid" alt="">
                        </div>
                      </li>
                      <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> I put two breakpoints to stop BeingDebugging in the first TLScallback 
                        <div class="portfolio-wrap mt-4 mb-4">
                          <img src="images/BlHt/25.png" class="img-fluid" alt="">
                        </div>
                      </li>
                      <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> I put two breakpoints to Make result = true  in the second TLScallback 
                        <div class="portfolio-wrap mt-4 mb-4">
                          <img src="images/BlHt/26.png" class="img-fluid" alt="">
                        </div>
                      </li>
                      <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> and in WinMain function I put two breakpoints to bypass the no argument
                        <div class="portfolio-wrap mt-4 mb-4">
                          <img src="images/BlHt/27.png" class="img-fluid" alt="">
                        </div>
                      </li>
                      <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> in first TLScallback we modify register value 
                        <div class="portfolio-wrap mt-4 mb-4">
                          <img src="images/BlHt/28.png" class="img-fluid" alt="">
                        </div>
                      </li>
                      <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> in second TLScallback we modify register value
                        <div class="portfolio-wrap mt-4 mb-4">
                          <img src="images/BlHt/29.png" class="img-fluid" alt="">
                        </div>
                      </li>
                      <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> but we get fake flag :(
                        <div class="portfolio-wrap mt-4 mb-4">
                          <img src="images/BlHt/30.png" class="img-fluid" alt="">
                        </div>
                      </li>
                      <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i> now let's bypass the no argument by set ip here
                        <div class="portfolio-wrap mt-4 mb-4">
                          <img src="images/BlHt/31.png" class="img-fluid" alt="">
                        </div>
                      </li>
                      <li class="list-group-item"><i class="bi bi-arrow-right-square-fill"></i>  and i found the flag
                        <div class="portfolio-wrap mt-4 mb-4">
                          <img src="images/BlHt/32.png" class="img-fluid" alt="">
                        </div>
                      </li>
                </ul>
            </div>
        </div>
    </div>













  <!-- footer container -->
  <div class="mt-5"><br></div>
  <nav class="navbar navbar-expand-lg py-3 fixed-bottom">
    <div class="pe-lg-0 ps-lg-5 container-fluid justify-content-between">
      <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
        <div class="nav_left d-lg-flex align-items-center">
          <nav>
            <div class="nav d-block d-lg-flex nav-tabs mgf" id="nav-tab" role="tablist">
              <button class="nav-link" type="button">This Website Designed by Mohamed Galal</button>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </nav>





    <!-- scripts -->
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/particles.min.js"></script>
    <script src="js/app.js"></script>
    <script src="js/wow.min.js"></script>
    <script>
    new WOW().init();
    </script>
</body>

</html>